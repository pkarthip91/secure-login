{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/80009078karthiperumal/Desktop/web-engineer/web-engineer-app/src/app/api/verifyMfa/route.js"],"sourcesContent":["let mfaStore = new Map()\n\nconst generateOTP = () =>\n  Math.floor(100000 + Math.random() * 900000).toString()\n\nexport async function POST(req) {\n  try {\n    const { username, code, action } = await req.json()\n    const key = username?.toLowerCase()\n    const record = mfaStore.get(key)\n\n    if (action === \"generate\") {\n      const otp = generateOTP()\n      mfaStore.set(key, { otp, attempts: 0, issuedAt: Date.now() })\n      console.log(`OTP for ${key}: ${otp}`)\n      return Response.json({ status: \"OTP generated\", otp }) // Return OTP\n    }\n\n    if (!record) return Response.json({ message: \"OTP not issued\" }, { status: 403 })\n    if (!code) return Response.json({ message: \"Missing code\" }, { status: 400 })\n    if (Date.now() - record.issuedAt > 2 * 60 * 1000)\n      return Response.json({ message: \"OTP expired\" }, { status: 403 })\n    if (record.attempts >= 3)\n      return Response.json({ message: \"Too many attempts\" }, { status: 403 })\n    if (record.otp !== code) {\n      mfaStore.set(key, { ...record, attempts: record.attempts + 1 })\n      return Response.json({ message: \"Invalid code\" }, { status: 401 })\n    }\n\n    mfaStore.delete(key)\n    return Response.json({ success: true })\n  } catch {\n    return Response.json({ message: \"Internal server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;AAAA,IAAI,WAAW,IAAI;AAEnB,MAAM,cAAc,IAClB,KAAK,KAAK,CAAC,SAAS,KAAK,MAAM,KAAK,QAAQ,QAAQ;AAE/C,eAAe,KAAK,GAAG;IAC5B,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,IAAI;QACjD,MAAM,MAAM,UAAU;QACtB,MAAM,SAAS,SAAS,GAAG,CAAC;QAE5B,IAAI,WAAW,YAAY;YACzB,MAAM,MAAM;YACZ,SAAS,GAAG,CAAC,KAAK;gBAAE;gBAAK,UAAU;gBAAG,UAAU,KAAK,GAAG;YAAG;YAC3D,QAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,IAAI,EAAE,EAAE,KAAK;YACpC,OAAO,SAAS,IAAI,CAAC;gBAAE,QAAQ;gBAAiB;YAAI,GAAG,aAAa;;QACtE;QAEA,IAAI,CAAC,QAAQ,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAiB,GAAG;YAAE,QAAQ;QAAI;QAC/E,IAAI,CAAC,MAAM,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAe,GAAG;YAAE,QAAQ;QAAI;QAC3E,IAAI,KAAK,GAAG,KAAK,OAAO,QAAQ,GAAG,IAAI,KAAK,MAC1C,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAc,GAAG;YAAE,QAAQ;QAAI;QACjE,IAAI,OAAO,QAAQ,IAAI,GACrB,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAoB,GAAG;YAAE,QAAQ;QAAI;QACvE,IAAI,OAAO,GAAG,KAAK,MAAM;YACvB,SAAS,GAAG,CAAC,KAAK;gBAAE,GAAG,MAAM;gBAAE,UAAU,OAAO,QAAQ,GAAG;YAAE;YAC7D,OAAO,SAAS,IAAI,CAAC;gBAAE,SAAS;YAAe,GAAG;gBAAE,QAAQ;YAAI;QAClE;QAEA,SAAS,MAAM,CAAC;QAChB,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAK;IACvC,EAAE,OAAM;QACN,OAAO,SAAS,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC3E;AACF","debugId":null}}]
}