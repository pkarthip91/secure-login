{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/80009078karthiperumal/Desktop/web-engineer/web-engineer-app/src/app/login/mfa/page.js"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { Input } from \"@/components/ui/input\"\nimport { Button } from \"@/components/ui/button\"\n\nexport default function MfaPage() {\n  const router = useRouter()\n  const [code, setCode] = useState(\"\")\n  const [otp, setOtp] = useState(\"\")\n  const [error, setError] = useState(\"\")\n\n  const username = typeof window !== \"undefined\" ? sessionStorage.getItem(\"username\") : \"\"\n\n  useEffect(() => {\n    if (!username) {\n      router.push(\"/login/username\")\n      return\n    }\n\n    // Get OTP from backend\n    const fetchOtp = async () => {\n      const res = await fetch(\"/api/verifyMfa\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ username, action: \"generate\" }),\n      })\n\n      const data = await res.json()\n      if (res.ok && data.otp) setOtp(data.otp)\n    }\n\n    fetchOtp()\n  }, [router, username])\n\n  const handleVerify = async (e) => {\n    e.preventDefault()\n    setError(\"\")\n\n    const res = await fetch(\"/api/verifyMfa\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ username, code }),\n    })\n\n    const data = await res.json()\n    if (res.ok) {\n      // Step 1: Save token\n      localStorage.setItem(\"token\", data.token || \"mock-token\")\n\n      // Step 2: Notify all listeners (like Navbar)\n      window.dispatchEvent(new Event(\"storage\"))\n\n      // Step 3: Redirect\n      router.push(\"/dashboard\")\n    } else {\n      setError(data.message || \"MFA failed\")\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center px-4\">\n      <form onSubmit={handleVerify} className=\"max-w-md w-full bg-white shadow p-6 rounded\">\n        <h1 className=\"text-2xl font-semibold mb-4\">Login - Step 4: MFA</h1>\n\n        {otp && (\n          <div className=\"text-sm text-green-600 mb-4\">\n            <strong>Your OTP is: {otp}</strong>\n          </div>\n        )}\n\n        <Input\n          type=\"text\"\n          placeholder=\"Enter 6-digit code\"\n          value={code}\n          onChange={(e) => setCode(e.target.value)}\n          required\n          maxLength={6}\n        />\n        {error && <p className=\"text-red-500 text-sm mt-2\">{error}</p>}\n        <Button type=\"submit\" className=\"w-full mt-4\">\n          Verify\n        </Button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC/B,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,MAAM,WAAW,6EAAqE;IAEtF,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,wCAAe;YACb,OAAO,IAAI,CAAC;YACZ;QACF;;QAEA,uBAAuB;QACvB,MAAM;IAYR,GAAG;QAAC;QAAQ;KAAS;IAErB,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,SAAS;QAET,MAAM,MAAM,MAAM,MAAM,kBAAkB;YACxC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAU;YAAK;QACxC;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,IAAI,IAAI,EAAE,EAAE;YACV,qBAAqB;YACrB,aAAa,OAAO,CAAC,SAAS,KAAK,KAAK,IAAI;YAE5C,6CAA6C;YAC7C,OAAO,aAAa,CAAC,IAAI,MAAM;YAE/B,mBAAmB;YACnB,OAAO,IAAI,CAAC;QACd,OAAO;YACL,SAAS,KAAK,OAAO,IAAI;QAC3B;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAK,UAAU;YAAc,WAAU;;8BACtC,8OAAC;oBAAG,WAAU;8BAA8B;;;;;;gBAE3C,qBACC,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;;4BAAO;4BAAc;;;;;;;;;;;;8BAI1B,8OAAC,iIAAA,CAAA,QAAK;oBACJ,MAAK;oBACL,aAAY;oBACZ,OAAO;oBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oBACvC,QAAQ;oBACR,WAAW;;;;;;gBAEZ,uBAAS,8OAAC;oBAAE,WAAU;8BAA6B;;;;;;8BACpD,8OAAC,kIAAA,CAAA,SAAM;oBAAC,MAAK;oBAAS,WAAU;8BAAc;;;;;;;;;;;;;;;;;AAMtD","debugId":null}}]
}